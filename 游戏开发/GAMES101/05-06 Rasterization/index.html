
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
        <link rel="prev" href="../03-04%20Transform/">
      
      
        <link rel="next" href="../07-09%20Shading/">
      
      
        
      
      
      <link rel="icon" href="../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.1">
    
    
      
        <title>L5-L6:Rasterization - SarrLight's Notebook</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.484c7ddc.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.ab4e12ef.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#1" class="md-skip">
          跳转至
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="页眉">
    <a href="../../.." title="SarrLight&#39;s Notebook" class="md-header__button md-logo" aria-label="SarrLight's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.45 4.73L5.82 21z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            SarrLight's Notebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              L5-L6:Rasterization
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="custom" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="标签" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../%E8%AF%BE%E5%86%85%E5%AD%A6%E4%B9%A0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" class="md-tabs__link">
          
  
  
  课内学习

        </a>
      </li>
    
  

      
        
  
  
  
    
  
  
    
    
      
  
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../03-04%20Transform/" class="md-tabs__link">
          
  
  
  游戏开发

        </a>
      </li>
    
  

    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="导航栏" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="SarrLight&#39;s Notebook" class="md-nav__button md-logo" aria-label="SarrLight's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 17.27 18.18 21l-1.64-7.03L22 9.24l-7.19-.62L12 2 9.19 8.62 2 9.24l5.45 4.73L5.82 21z"/></svg>

    </a>
    SarrLight's Notebook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    课内学习
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    课内学习
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../%E8%AF%BE%E5%86%85%E5%AD%A6%E4%B9%A0/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    计算机组成
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../课内学习/高级数据结构.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    高级数据结构
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    
  
    游戏开发
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            
  
    游戏开发
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    
    
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_1" checked>
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    
  
    GAMES101
  

    
  </span>
  
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            
  
    GAMES101
  

          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../03-04%20Transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L3-L4:Transform
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    L5-L6:Rasterization
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    L5-L6:Rasterization
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 概念回顾
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 光栅化
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 光栅化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 屏幕坐标空间的特点
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 采样(Sample)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 反走样
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 反走样">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.1 奈奎斯特定理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.2 解决方法
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 深度绘制
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 深度绘制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241-painters-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.1 画家算法（Painters’ Algorithm）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.2 深度缓冲
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../07-09%20Shading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L7-L9:Shading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../10-12%20Geometry/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L10-L12:Geometry
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../13-16%20Ray%20Tracing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    L13-L16:Ray Tracing
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BD%9C%E4%B8%9A1-%E7%94%BB%E4%B8%89%E8%A7%92%E5%BD%A2/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    作业1-画三角形
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BD%9C%E4%B8%9A2-Rasterization/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    作业2-Rasterization
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BD%9C%E4%B8%9A3-Shading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    作业3-Shading
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../%E4%BD%9C%E4%B8%9A4-Bazier%20Curve/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    作业4-BazierCurve
  

    
  </span>
  
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="目录">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      目录
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#1" class="md-nav__link">
    <span class="md-ellipsis">
      
        1 概念回顾
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2" class="md-nav__link">
    <span class="md-ellipsis">
      
        2 光栅化
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2 光栅化">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#21" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.1 屏幕坐标空间的特点
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-sample" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.2 采样(Sample)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3 反走样
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.3 反走样">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#231" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.1 奈奎斯特定理
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#232" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.3.2 解决方法
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4 深度绘制
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="2.4 深度绘制">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#241-painters-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.1 画家算法（Painters’ Algorithm）
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#242" class="md-nav__link">
    <span class="md-ellipsis">
      
        2.4.2 深度缓冲
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



  <h1>L5-L6:Rasterization</h1>

<p><a href="https://tanyuu.github.io/2024.01-07/GAMES101%E7%AC%94%E8%AE%B0/#lecture-05-rasterization-1-triangles%E5%85%89%E6%A0%85%E5%8C%961-%E4%B8%89%E8%A7%92%E5%BD%A2">GAMES101（现代计算机图形学入门）笔记 - Yu_Tang</a></p>
<h2 id="1">1 概念回顾</h2>
<p>视角变换之后，所有的物体均已经变换至<span class="arithmatex">\({[-1,1]}^3\)</span>的空间中，接下来应该考虑如何将其绘制出来；</p>
<p>视角（field-of-view），fovY为垂直视场角，fovX为水平视场角，此课程中fov默认为垂直视场角；</p>
<p>在视角变换之后，相机位于原点， <span class="arithmatex">\(y^{+}\)</span>轴为上，<span class="arithmatex">\(z^{-}\)</span>轴为朝向，即有<span class="arithmatex">\(l=-r,b=-t\)</span>；</p>
<p>考虑 fovY 、aspect_ratio 与 l, r, b, t 的关系，如图所示：<br />
<img alt="Pasted image 20251022130956.jpg" src="../Pasted%20image%2020251022130956.jpg" /></p>
<div class="arithmatex">\[
\begin{align}
&amp;\tan\frac{fovY}2=\frac t{|n|}\\
&amp;aspect=\frac r t
\end{align}
\]</div>
<h2 id="2">2 光栅化</h2>
<p>我们将屏幕视为二维数组，<strong>光栅化（rasterize）</strong> 即为在屏幕上绘制的过程；</p>
<h3 id="21">2.1 屏幕坐标空间的特点</h3>
<p>此课程中规定，屏幕空间的像素坐标视作分别代表X、Y轴位置的整数数对，如下图蓝色位置为 (2,1) ；</p>
<figure><br />
<img alt="Pasted image 20251022131138.png" src="../Pasted%20image%2020251022131138.png" width="400" /><br />
<br />
</figure>
<p>于 <span class="arithmatex">\(\text {width}\times \text{height}\)</span> 的屏幕，其像素坐标范围为 (0, 0) 到 (width-1, height-1) ；</p>
<p>虽然像素坐标为整数坐标，但是坐标为 (x, y) 的像素中心在 (x+0.5, y+0.5) ；屏幕覆盖范围为 (0, 0) 到 (width, height) ；<br />
我们需要完成从<span class="arithmatex">\({[-1,1]}^{3}\)</span>到<span class="arithmatex">\([0,width]\times[0,height]\)</span>的映射；</p>
<p>我们先不考虑 z 坐标，将 xy 坐标拉伸至屏幕范围，有视口变换矩阵：</p>
<div class="arithmatex">\[M_{viewport}=
\begin{bmatrix}
\frac {width}2&amp;0&amp;0&amp;\frac {width}2\\
0&amp;\frac {height}2&amp;0&amp;\frac {height}2\\
0&amp;0&amp;1&amp;0\\
0&amp;0&amp;0&amp;1
\end{bmatrix}\]</div>
<h3 id="22-sample">2.2 采样(Sample)</h3>
<p>定义布尔函数 <code>inside(tri, x, y)</code> ，其中xy不要求整数，含义为：</p>
<div class="arithmatex">\[\text{inside}(tri,x,y)=
\begin{cases}
1&amp;(x,y) \text{ in triangle }tri\\
0&amp;\text{otherwise}
\end{cases}\]</div>
<div class="highlight"><pre><span></span><code><span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">xmax</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">x</span><span class="p">)</span><span class="w">  </span>
<span class="k">for</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ymax</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">y</span><span class="p">)</span><span class="w">  </span>
<span class="n">image</span><span class="p">[</span><span class="n">x</span><span class="p">][</span><span class="n">y</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inside</span><span class="p">(</span><span class="n">tri</span><span class="p">,</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mf">0.5</span><span class="p">);</span>
</code></pre></div>
<p>可以用同侧法来判断点是否在三角形内</p>
<div class="admonition important">
<p class="admonition-title">具体判断步骤</p>
<p><strong>具体判断步骤（以三角形 ABC 和点 P 为例）</strong><br />
需构建 3 组 “边向量” 和 “点到边的向量”，通过叉乘方向是否一致来判断：<br />
① 对边 AB：构建向量 <code>AB = B - A</code>、<code>AP = P - A</code>，计算叉乘 <code>cross1 = AB × AP</code>；<br />
② 对边 BC：构建向量 <code>BC = C - B</code>、<code>BP = P - B</code>，计算叉乘 <code>cross2 = BC × BP</code>；<br />
③ 对边 CA：构建向量 <code>CA = A - C</code>、<code>CP = P - C</code>，计算叉乘 <code>cross3 = CA × CP</code>。<br />
若 <strong>cross1、cross2、cross3 全部同号（均正或均负）</strong>，说明点 P 始终在三角形三边的 “同一侧”（均在三边的逆时针侧或均在顺时针侧），则 P 在三角形内；若存在异号，则 P 在外部；若某一叉乘为 0，说明 P 在对应边上（需按规则统一处理，如归为 “在内部” 或 “在外部”，避免重复计数）。</p>
</div>
<p>关于点在边界上的情况，按统一标准处理即可；<br />
考虑枚举所有像素的低效，我们可以只扫描三角形轴向包围盒（axis-aligned bounding box，AABB）中的像素（<span class="arithmatex">\([X_{min},X_{max}]\times[Y_{min},Y_{max}]\)</span>）；<br />
对于细长且旋转的三角形，AABB 策略会被降低效率，可以使用增量遍历策略：</p>
<figure><br />
<img alt="Pasted image 20251022132626.png" src="../Pasted%20image%2020251022132626.png" width="400" /><br />
<br />
</figure>
<p>从三角形左下角的顶点所在的像素开始，逐个像素向右遍历，直到某个像素的中心在三角形外部，之后向上移动一个像素，继续向右遍历</p>
<h3 id="23">2.3 反走样</h3>
<p>走样：CG（Computer Graphic)中不符合预期的采样（Sampling Artifacts (Errors/Mistakes/Inaccuracies) in Computer Graphics），包括锯齿、摩尔纹、车轮效应等；</p>
<h4 id="231">2.3.1 <strong>奈奎斯特定理</strong></h4>
<p>奈奎斯特定理，又称为<strong>香农采样定理</strong>,<br />
奈奎斯特定理指出，为了不失真地恢复模拟信号，采样频率应该大于等于模拟信号频谱中最高频率的两倍，即：<br />
<span class="arithmatex">\(f_{s} ≥ 2f_{max}\)</span></p>
<div class="admonition note">
<p class="admonition-title">频谱与傅里叶变换</p>
<p>傅里叶变换的核心作用是 “域的转换”，而频谱就是这个转换的直接产物。<br />
1. <strong>输入：时域信号</strong>。比如一段音乐的波形图，横轴是时间，纵轴是声音的强弱（振幅），这就是典型的时域信号。<br />
2. <strong>处理：傅里叶变换</strong>。它会把这个时域信号拆解成无数个不同频率的正弦波 —— 这些正弦波就是信号的 “基本组成单元”。<br />
3. <strong>输出：频域频谱</strong>。将拆解后的所有频率成分，按 “频率高低” 排序，再标注每个频率成分的 “强度”（或相位），最终形成的图形或数据就是频谱。</p>
</div>
<div class="admonition note">
<p class="admonition-title">离散傅里叶变换（DFT）</p>
<p>不用公式的话，可以把它理解成：给你一串 “时间点上的信号值”（比如每秒采 1 个点，采了 10 个点），DFT 能算出 “这串信号里包含哪些频率（比如 2Hz、5Hz），每个频率的信号有多强”，而且这些频率是 “离散的、不连续的”。</p>
</div>
<p>1、定义 “理想采样” 与信号模型<br />
连续带限信号 <span class="arithmatex">\(x(t)\)</span>，其最高频率为 <span class="arithmatex">\(f_m\)</span>（即当 <span class="arithmatex">\(|f| &gt; f_m\)</span>时，频谱 <span class="arithmatex">\(X(f) = 0\)</span>)；<br />
采样周期为 <span class="arithmatex">\(T_s\)</span>，采样频率 <span class="arithmatex">\(F_s = \frac{1}{T_s}\)</span>；<br />
理想采样信号<span class="arithmatex">\(x_s(t)\)</span>是<span class="arithmatex">\(x(t)\)</span>与冲激采样串 <span class="arithmatex">\(p(t) = \sum_{n=-\infty}^{\infty} \delta(t - nT_s)\)</span>的乘积，即：</p>
<div class="arithmatex">\[x_s(t) = x(t) \cdot p(t) = x(t) \sum_{n=-\infty}^{\infty} \delta(t - nT_s) = \sum_{n=-\infty}^{\infty} x(nT_s) \delta(t - nT_s)\]</div>
<p>2、求采样信号的傅里叶变换 <span class="arithmatex">\(X_s(f)\)</span><br />
根据傅里叶变换的 <strong>“时域乘积→频域卷积”</strong> 性质，若 <span class="arithmatex">\(x_s(t) = x(t) \cdot p(t)\)</span>，则其傅里叶变换为：<br />
<span class="arithmatex">\(X_s(f) = X(f) * P(f)\)</span><br />
其中，<span class="arithmatex">\(P(f)\)</span> 是冲激采样串 <span class="arithmatex">\(p(t)\)</span> 的傅里叶变换。<br />
冲激采样串 <span class="arithmatex">\(p(t) = \sum_{n=-\infty}^{\infty} \delta(t - nT_s)\)</span> 的傅里叶变换为冲激串</p>
<div class="arithmatex">\[P(f) = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} \delta(f - kF_s)\]</div>
<p>（推导：冲激串是周期信号，周期 <span class="arithmatex">\(T_s\)</span>，其傅里叶级数系数为 <span class="arithmatex">\(\frac{1}{T_s}\)</span>，因此傅里叶变换是间隔 <span class="arithmatex">\(F_s\)</span>、幅度 <span class="arithmatex">\(\frac{1}{T_s}\)</span> 的冲激串。）</p>
<div class="arithmatex">\[X_s(f) = X(f) * \frac{1}{T_s} \sum_{k=-\infty}^{\infty} \delta(f - kF_s) = \frac{1}{T_s} \sum_{k=-\infty}^{\infty} X(f - kF_s)\]</div>
<p>这表明：采样后的频谱是原频谱以 <span class="arithmatex">\(F_s\)</span> 为周期的无限重复（频谱副本）。<br />
3、推导 “无混叠” 的采样条件<br />
要从 <span class="arithmatex">\(x_s(t)\)</span> 无失真恢复 <span class="arithmatex">\(x(t)\)</span>，需保证各频谱副本之间无重叠（即 “无混叠”）。</p>
<p>由于原信号是带限的（<span class="arithmatex">\(|f| &gt; f_m\)</span> 时 <span class="arithmatex">\(X(f) = 0\)</span>），第 <span class="arithmatex">\(k=1\)</span> 个频谱副本 <span class="arithmatex">\(X(f - F_s)\)</span> 的有效范围是：</p>
<div class="arithmatex">\[f - F_s \in [-f_m, f_m] \implies f \in [F_s - f_m, F_s + f_m]\]</div>
<p>为了让 <span class="arithmatex">\(X(f - F_s)\)</span><br />
与原频谱 <span class="arithmatex">\(X(f)\)</span>（范围 <span class="arithmatex">\([-f_m, f_m]\)</span>）不重叠，需满足：</p>
<div class="arithmatex">\[F_s - f_m \geq f_m即F_s \geq 2f_m\]</div>
<figure><br />
<img alt="Pasted image 20251022154454.png" src="../Pasted%20image%2020251022154454.png" width="500" /><br />
<br />
</figure>
<p>如果采样率不足（fs较小）或高频丰富（f0较大）时，便会发生频谱混叠（aliasing），即为走样；<br />
进一步说，除了<strong>增加采样率</strong>外，还可以通过<strong>先低通滤波再采样</strong>的方法；</p>
<figure><br />
<img alt="Pasted image 20251022154510.png" src="../Pasted%20image%2020251022154510.png" width="500" /><br />
<br />
</figure>
<h4 id="232">2.3.2 解决方法</h4>
<p>超采样(Super-Sample Anti-Aliasing, SSAA)<br />
将每个像素划分为更多小的像素，分别对小像素进行采样后进行平均；</p>
<p>多重采样（Multi-Sample AA，MSAA）<br />
不同于SSAA，SSAA对于所有子采样点着色，而MSAA只对当前模型所更新的子采样点进行着色；<br />
SSAA与MSAA都需要进行解析（Resolve），信号必须重新采样到指定的分辨率，这样我们才可以显示它；<br />
SSAA和MSAA会大量消耗算力，实际实现上可能通过不规则分布和像素复用等方法降低消耗；</p>
<p>快速近似（Fast Approximate AA，FXAA）<br />
在光栅化后带锯齿的图像上寻找边界，将边界替换为没有锯齿的边界；</p>
<p>时域抗锯齿（Temporal AA，TAA）<br />
类似于在时域上进行多重采样；</p>
<p>深度学习超分辨率（Deep Learning Super Sampling，DLSS）</p>
<h3 id="24">2.4 深度绘制</h3>
<h4 id="241-painters-algorithm">2.4.1 画家算法（Painters’ Algorithm）</h4>
<p>从远到近绘制，近的物体覆盖远的物体；<br />
同距离物体的绘制顺序并不随意，会出现遮挡问题：<br />
也可能出现无法解决的深度组合：<br />
<img alt="Pasted image 20251022164744.png" src="../Pasted%20image%2020251022164744.png" /></p>
<h4 id="242">2.4.2 深度缓冲</h4>
<p><em>为了简单起见，此部分我们认为 z 总是正的，z 越小物体离相机越近</em><br />
在渲染图像时同时生成两个结果：对于想要的图像存储在 frame buffer ，对于每个像素的深度信息存储在 depth buffer；<br />
深度缓存对于每个像素，只维护此帧中最小的 z 值；<br />
<div class="highlight"><pre><span></span><code>lnitialize depth buffer to ∞;  
During rasterization:  
    foreach (triangle T)  
        foreach (sample (x,y,z) in T)  
            if (z &lt; zbuffer[x,y]) // closest sample so far  
                framebuffer[x,y] = rgb; // update color  
                zbuffer[×,y] = z; // update depth  
            else  
                ; // do nothing, this sample is occluded
</code></pre></div><br />
在 MSAA 策略下，z-buffer 粒度会上升至每一个采样点；<br />
z-buffer 不能处理透明物体的深度问题；</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  回到页面顶部
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "../../..", "features": ["navigation.top", "navigation.tabs", "search.highlight"], "search": "../../../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
    
    
      <script src="../../../assets/javascripts/bundle.79ae519e.min.js"></script>
      
        <script src="../../../javascripts/mathjax.js"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>